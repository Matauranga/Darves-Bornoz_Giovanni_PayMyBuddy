<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <title>Profile</title>
</head>
<body>
<div th:insert="~{/navbar :: topbar}"></div>


<div class="container bootstrap snippets bootdey">
    <h1 class="text-primary">Edit Profile</h1>
    <div class="row">

        <!-- left column -->
        <div class="col-md-3">
            <div class="text-left">
                <img width="200px" height="70px" th:src="@{/PayMyBuddyPicture.png}" alt="avatar"/>
            </div>
        </div>

        <!-- edit form column -->
        <div class="col-md-9 personal-info">

            <h3>Personal info</h3>

            <!-- Edit profile -->
            <div class="open-btn bg-light clearfix">
                <h5 class="text-left">Send Money
                    <button type="button" class="open-button btn btn-primary float-end" onclick="openForm()">
                        Edit profile
                    </button>
                </h5>
            </div>

            <div id="login-popup">
                <div class="form-popup"
                     id="popupForm"
                     style=" display: none;
                     position: fixed;
                     left: 60%;
                     top: 25%;
                     transform: translate(-45%, 5%);
                     border: 2px solid #666;
                     z-index: 9;"
                >

                    <form method="POST"
                          class="form-container"
                          th:action="@{/profile/edit}"
                          th:object="${UpdatePersonDTO}"
                          style=" width: 400px;padding: 20px;background-color: #fff;"
                    >
                        <span>Change profile settings, if you don't write anything, no changes will apply</span>
                        <div class="my-4">
                            <input
                                    type="text"
                                    class="form-control"
                                    name="firstname"
                                    placeholder="Firstname"
                                    th:field="*{firstname}"
                                    style="font-family:Arial, FontAwesome"
                                    id="firstname" maxlength="30"
                            />
                        </div>

                        <div class="my-4">
                            <input
                                    type="text"
                                    class="form-control"
                                    name="lastname"
                                    placeholder="Lastname"
                                    th:field="*{lastname}"
                                    style="font-family:Arial, FontAwesome"
                                    id="lastname" maxlength="30"
                            />
                        </div>

                        <div class="text-center my-3">
                            <button type="submit" class="btn btn-primary" value="saveModification">Save</button>
                            <button type="button" class="btn btn-danger cancel " onclick="closeForm()">Fermer</button>
                        </div>
                    </form>
                </div>
            </div>


            <div class="form-group">
                <label class="col-lg-3 control-label">Firstname:</label>
                <div class="form-control col-lg-8"
                     th:text="${personInformationDTO.getFirstname()}">
                </div>
            </div>

            <div class="form-group">
                <label class="col-lg-3 control-label">Lastname:</label>
                <div class="form-control col-lg-8"
                     th:text="${personInformationDTO.getLastname()}">
                </div>
            </div>

            <div class="form-group">
                <label class="col-lg-3 control-label">Birthdate:</label>
                <div class="form-control col-lg-8"
                     th:text="${personInformationDTO.getBirthdate()}">
                </div>
            </div>

            <div class="form-group">
                <label class="col-lg-3 control-label">Email:</label>
                <div class="form-control col-lg-8"
                     th:text="${personInformationDTO.getEmail()}">
                </div>
            </div>

            <div class="form-group">
                <label class="col-lg-3 control-label">Account balance:</label>
                <div class="form-control col-lg-8"
                     th:text="${personInformationDTO.getAccountBalance()}">
                </div>
            </div>


            <div class="form-group">
                <label class="col-lg-3 control-label">friends list:</label>

                <select class="form-control"
                        name="connection"
                        id="connection" required>
                    <!--  th:field="*{creditorEmail}"-->

                    <option
                            th:each="friend : ${personInformationDTO.getFriendsList()}"
                            th:value="${friend}"
                            th:text="${friend}"
                    >
                    </option>
                </select>

                <div class="table-responsive">
                    <table
                            class="table table-striped table-hover table-bordered mt-2"
                            id="transactionTable">
                        <thead>
                        <label class="col-lg-5 control-label">Transaction with friend selected:</label>
                        <tr class="bg-success text-white">
                            <th>Connection</th>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Amount</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="transaction: ${transactionsList}">
                            <td th:text="${transaction.getCreditor().getFirstname() + ' ' + transaction.getCreditor().getLastname()}"></td>
                            <td th:text="${transaction.getOperationDate()}"></td>
                            <td th:text="${transaction.getDescription()}"></td>
                            <td th:text="${transaction.getTransferAmount()+'â‚¬'}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>


        </div>
    </div>
</div>


<script>

      function openForm() {
        document.getElementById("popupForm").style.display = "block";
      }

      function closeForm() {
        document.getElementById("popupForm").style.display = "none";
      }

</script>

</body>
</html>